package net.pureal.traits.math.operations

import net.pureal.traits.math.*
import net.pureal.traits.*

public trait SubtractionValue : RealBinaryOperation {

    public class object : Constructor2<SubtractionValue, Real, Real> {
        override fun invoke(a: Real, b: Real): SubtractionValue = object : SubtractionValue, Calculatable() {
            override val subReals: Array<Real> = array(a,b)
        }
    }

    private val constructor: Constructor2<SubtractionValue, Real, Real> get() = SubtractionValue

    final override val priority: Int
        get() = 0

    override val description: String
        get() = "Subtraction"

    final override val operationSign: String
        get() = "-"

    final override val isOrderDependent: Boolean
        get() = true

    override fun approximate(): InternalReal {
        return value1.approximate() - value2.approximate()
    }

    override fun calculate(): Real {
        val s1: Real = value1.calculate()
        val s2: Real = value2.calculate()
        if (s1 is RealPrimitive && s2 is RealPrimitive) return real(s1.value - s2.value)

        // return this if no simplification is possible
        return this
    }

    override fun minus(): SubtractionValue = SubtractionValue.invoke(-value1, -value2)

    override val isPositive: Boolean get() = value1.isPositive || !value2.isPositive
}

